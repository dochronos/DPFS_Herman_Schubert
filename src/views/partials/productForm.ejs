<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-8 border rounded p-5 shadow bg-light">

      <form id="productForm" class="container <%= formClass %>" action="<%= formAction %>" method="POST"
        enctype="multipart/form-data">
        <% if (formMethod === 'PUT') { %>
          <input type="hidden" name="_method" value="PUT">
        <% } %>

        <h2 class="mb-4 fw-bold" style="font-family: 'Garamond', serif;">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"
            fill="#000000" class="me-2">
            <path d="M320-240h320v-80H320v80Zm0-160h320v-80H320v80ZM240-80q-33 0-56.5-23.5T160-160v-640q0-33 23.5-56.5T240-880h320l240 240v480q0 33-23.5 56.5T720-80H240Zm280-520v-200H240v640h480v-440H520Z"/>
          </svg>
          <%= formTitle %>
        </h2>

        <div class="mb-3">
          <label for="name" class="form-label">Nombre del producto</label>
          <input type="text" id="name" name="name" class="form-control"
            value="<%= product?.name || '' %>" autocomplete="off"
            placeholder="Ej. Humidificador floral Quantum"
            <%= !product ? 'autofocus' : '' %> aria-describedby="nameError">
          <div id="nameError" class="form-text text-danger"></div>
        </div>

        <div class="mb-3">
          <label for="brand" class="form-label">Marca</label>
          <select id="brand" name="brand" class="form-select">
            <% brands?.forEach(brand => { %>
              <option value="<%= brand.id %>" <%= product?.Brand?.id === brand.id ? 'selected' : '' %>>
                <%= brand.name %>
              </option>
            <% }) %>
          </select>
        </div>

        <div class="mb-3">
          <label for="description" class="form-label">Descripción</label>
          <textarea id="description" name="description" class="form-control" rows="4"
            placeholder="Describe este producto de manera emocional y sensorial"
            aria-describedby="descriptionError"><%= product?.description || '' %></textarea>
          <div id="descriptionError" class="form-text text-danger"></div>
        </div>

        <div class="mb-3">
          <label for="image" class="form-label">Imagen</label>
          <input type="file" id="image" name="image" class="form-control" accept="image/*" aria-describedby="imageError">
          <% if (product?.image) { %>
            <small class="form-text">Imagen actual: <%= product.image %></small>
          <% } %>
          <div id="imageError" class="form-text text-danger"></div>
        </div>

        <div class="mb-3">
          <label for="category" class="form-label">Categoría</label>
          <select id="category" name="category" class="form-select">
            <% categories?.forEach(category => { %>
              <option value="<%= category.id %>" <%= product?.Category?.id === category.id ? 'selected' : '' %>>
                <%= category.name %>
              </option>
            <% }) %>
          </select>
        </div>

        <div class="mb-3">
          <label for="colors" class="form-label">Colores disponibles</label>
          <select id="colors" name="colors" class="form-select" multiple aria-describedby="colorsHelp">
            <% colors?.forEach(color => { %>
              <option value="<%= color.id %>" <%= product?.Colors?.some(prodColor => prodColor.id === color.id) ? 'selected' : '' %>>
                <%= color.name %>
              </option>
            <% }) %>
          </select>
          <small id="colorsHelp" class="form-text">Usa Ctrl (o Cmd en Mac) para seleccionar varios</small>
        </div>

        <div class="mb-3">
          <label for="price" class="form-label">Precio</label>
          <input type="number" id="price" name="price" class="form-control" step="0.01" min="0"
            value="<%= product?.price || '' %>">
        </div>

        <div class="mb-3">
          <label for="size" class="form-label">Tamaño</label>
          <input type="text" id="size" name="size" class="form-control" value="<%= product?.size || '' %>">
        </div>

        <div class="mb-4">
          <label for="officialWeb" class="form-label">Enlace oficial del producto</label>
          <input type="url" id="officialWeb" name="officialWeb" class="form-control" autocomplete="off"
            value="<%= product?.officialWeb || '' %>">
        </div>

        <button type="submit" class="btn w-100 py-2 text-white"
          style="background: linear-gradient(90deg, #c084fc, #6ee7b7); font-weight: 600;">
          <%= buttonText %>
        </button>
      </form>

    </div>
  </div>
</div>
